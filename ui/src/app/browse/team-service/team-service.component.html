<div class="service-header">
  <div class="service-link">
    <mat-chip-listbox [selectable]="false" class="service-target-chip">
      <mat-chip-option
        [ngStyle]="{'background-color': '#' + configRecord['service'].color}"
        (click)="navigateToService($event)">
        <span [ngStyle]="{color: getVisibleTextColor(configRecord['service'].color)}">
          {{service().edge.prototype.targetName}}
        </span>
      </mat-chip-option>
    </mat-chip-listbox>
  </div>
  <div class="service-title">
    {{ service().edge.prototype.name }}
  </div>
  <div class="service-actions">
    @if (hasUpdate()) {
      <button
        [disabled]="!hasUpdate()"
        mat-stroked-button
        (click)="editEdge()">Edit</button>
    }

    @if (service().links?.default) {
      <a
        mat-stroked-button
        href="{{service().links?.default}}"
        target="_blank">Open <mat-icon iconPositionEnd fontIcon="open_in_new"></mat-icon></a>
    }
  </div>
</div>

<p class="service-description">{{service().edge.prototype.description}}</p>

@if (service().instance?.prop) {
  <table mat-table [dataSource]="service().edge.prototype.property | keyvalue">
    <!-- Key Column -->
    <ng-container matColumnDef="key">
      <th mat-header-cell *matHeaderCellDef> Key </th>
      <td mat-cell *matCellDef="let element" matTooltip="Property: {{element.key}}" matTooltipShowDelay="500"> {{element.value.name}}</td>
    </ng-container>
    <!-- Value Column -->
    <ng-container matColumnDef="value">
      <th mat-header-cell *matHeaderCellDef> Value </th>
      <td mat-cell *matCellDef="let element" matTooltip="{{element.value.hint}}" matTooltipShowDelay="500">
        <div class="parent-ellipsis">
          @if (service().instance?.prop?.[element.key]) {
            <span class="ellipsis">{{service().instance?.prop?.[element.key]}}</span>
          }
          @if (showHelp()) {
            <small class="ellipsis">{{element.value.hint}}</small>
          }
        </div>
      </td>
    </ng-container>
    <tr mat-row *matRowDef="let row; columns: propDisplayedColumns;"></tr>
  </table>
}
